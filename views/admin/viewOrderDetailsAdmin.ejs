<%- include("../partials/adminHeader") %>
        <section class="content-main">
           
          <div class="content-header">
              <div>
                  <h2 class="content-title card-title">Order Details </h2>
                  
                 
              </div>
              
          </div>
          <div class="card">
              
              <div class="card-body">
                <div class="col-md-12">
                   
                 

                  <div class="table-responsive">
                      <table class="table table-hover">
                          <thead>
                              <tr>
                                  <th class="col-md-2">Image</th>
                                  <th class="col-md-3 text-center ">Product</th>
                                  <th class="col-md-1 text-center">Unit Price</th>
                                  <th class="col-md-1 text-center">Quantity</th>
                                  <th class="col-md-1 text-center">Size</th>
                                  <th class="col-md-2 text-center">Status</th>
                                  <th class="col-md-2 text-center">Change Status</th>
                                
                              </tr>
                          </thead>
                          <tbody>

                            <% if(orderData){%>
                                  <% for(i=0;i<orderData.length;i++){%>
                                    <tr>
                                      <td class="col-image col-md-2 ">
                                        <div class="itemside ">
                                          <div class="left ">
                                              <img  style="max-width:100%; height: auto;" src="/public/uploads/product-images/<%= orderData[i].productImage[0] %>" 
                                                   class="img-sm img-thumbnail" 
                                                   alt="Item" 
                                                   width="100%" 
                                                   height="100%" 
                                                   
                                              >
                                          </div>
                                      </div>
                                      
                                      </td>
                                      <th class="col-md-3 text-center text-primary bold"><h5 class="text-primary"><%= orderData[i].productName %></h5></th>
                                      <th class="col-md-2 text-center"><%= orderData[i].products.productPrice %></th>
                                      <th class="col-md-1 text-center"><%= orderData[i].products.quantity %></th>
                                      <th class= "col-md-1 text-center"><%= orderData[i].products.size.toUpperCase() %></th>
                                      <th class="col-md-2 text-center">
                                        <% if (orderData[i].products.status == 'Pending') { %>
                                          <span id="status" class="badge rounded-pill alert-warning"><%= orderData[i].products.status %></span>
                                      <% } else if (orderData[i].products.status == 'Processing') {%>
                                          <span id="status" class="badge rounded-pill alert-secondary"><%= orderData[i].products.status %></span>
                                      <% } else if (orderData[i].products.status == 'Confirmed') {%>
                                          <span id="status" class="badge rounded-pill alert-dark"><%=orderData[i].products.status %></span>
                                      <% } else if (orderData[i].products.status == 'Shipped') {%>
                                          <span id="status" class="badge rounded-pill alert-info"><%= orderData[i].products.status %></span>
                                      <% } else if (orderData[i].products.status == 'OutForDelivery') {%>
                                          <span id="status" class="badge rounded-pill alert-warning"><%= orderData[i].products.status %></span>
                                      <% } else if (orderData[i].products.status == 'Delivered') {%>
                                          <span id="status" class="badge rounded-pill alert-success"><%= orderData[i].products.status %></span>
                                      <% } else if (orderData[i].products.status == 'cancelPending') {%>
                                          <span id="status" class="badge rounded-pill alert-warning"><%= orderData[i].products.status %></span>
                                      <% } else {%>
                                          <span id="status" class="badge rounded-pill alert-danger"><%= orderData[i].products.status %></span>
                                      <% } %>
                                      </th>
                                      <td width="10%" >
                                        <% if (orderData[i].products.status == 'Pending') { %>
                                            <a id="changeStatus<%= orderData[i].products.product %>" onclick="changeOrderStatus('<%= orderData[i]._id %>','<%= orderData[i].products.size %>','<%= orderData[i].products.product %>','Processing')" class="btn btn-outline-primary rounded font-sm">Processing</a>
                                        <% } else if (orderData[i].products.status == 'Processing') { %>
                                            <a id="changeStatus<%= orderData[i].products.product %>" onclick="changeOrderStatus('<%= orderData[i]._id %>','<%= orderData[i].products.size %>','<%= orderData[i].products.product %>','Confirmed')" class="btn btn-outline-primary rounded font-sm">Confirmed</a>
                                        <% } else if (orderData[i].products.status == 'Confirmed') { %>
                                            <a id="changeStatus<%= orderData[i].products.product %>" onclick="changeOrderStatus('<%= orderData[i]._id %>','<%= orderData[i].products.size %>','<%= orderData[i].products.product %>','Shipped')" class="btn btn-outline-primary rounded font-sm">Shipped</a>
                                        <% } else if (orderData[i].products.status == 'Shipped') { %>
                                            <a id="changeStatus<%= orderData[i].products.product %>" onclick="changeOrderStatus('<%= orderData[i]._id %>','<%= orderData[i].products.size %>','<%= orderData[i].products.product %>','OutForDelivery')" class="btn  btn-outline-primary rounded font-sm">Out for delivery</a>
                                        <% } else if (orderData[i].products.status == 'OutForDelivery') { %>
                                            <a id="changeStatus<%= orderData[i].products.product %>" onclick="changeOrderStatus('<%= orderData[i]._id %>','<%= orderData[i].products.size %>','<%= orderData[i].products.product %>','Delivered')" class="btn btn-outline-primary rounded font-sm">Delivered</a>
                                        <% } else if (orderData[i].products.status == 'Return pending') { %>
                                            <a id="changeStatus<%= orderData[i].products.product %>" onclick="changeOrderStatus('<%= orderData[i]._id %>','<%= orderData[i].products.size %>','<%= orderData[i].products.product %>','Returned','<%= orderData[i].products.productPrice %>','<%= orderData[i].userId %>','<%= orderData[i].products.quantity %>')" class="btn btn-outline-primary rounded font-sm">Approve Return</a>
                                        <% }
                                        
                                        %>
                                    </td>
                                     
                                     
                                      
                                    </tr>
                                    
                                      


                                    <%} %>  


                              <%} %>
                      

                                
                                  
                                
                          
                                  
                            
                          
                            
                          </tbody>
                        </table>
                        <!-- Modal -->
                        <!-- Modal -->
<!-- Modal -->
<!-- Modal -->              <!-- Modal -->
<!-- Modal -->
<!-- <div id="reasonModal" class="modal">
    <div class="modal-content">
        <span class="close" onclick="closeModal()">&times;</span>
        <h2>Reason for Return</h2>
        <p id="reasonText"></p>
    </div>
</div> -->


<div class="modal fade" id="reasonModal" tabindex="-1" role="dialog" aria-labelledby="returnModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="returnModalLabel">Return Product</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form id="returnForm">
                    <!-- Hidden fields to store orderId, productId, size, and quantity -->

                    <div class="form-group">
                        <label for="returnReason">Reason for Return</label>
                        <p id="reasonText"></p>
                        <textarea class="form-control" id="returnReason" name="returnReason" rows="3"></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" id="submitReturn" onclick="closeModal()">Close</button>
            </div>
        </div>
    </div>
</div>



  
  
                    </div>
                  </div>
                  
                
                  
                  

                  
               <!-- .row // -->
              </div> <!-- card body .// -->
          </div> <!-- card .// -->
          <!-- <div class="row mb-50">
            <div class="col-lg-6 col-md-12">
              <div class="col-md-6">
                <div class="mb-25">
                    <h4>Address Details</h4>
                </div>
                
                <div class="row mb-25">
                  <div class="col">
                    
                      <ul class="list-group">
                        
                          <li class="list-group-item">
                              <div>
                                  <span><strong>Name:</strong>
                                    
                                  </span>
                              </div>
                              <div>
                                  <span><strong>Mobile:</strong>
                                    
                                  </span>
                              </div>
                              <div>
                                  <span><strong>House:</strong>
                                      Oruvelil House
                                  </span>
                              </div>
                              <div>
                                  <span><strong>City:</strong>
                                      Town
                                  </span>
                              </div>
                              <div>
                                  <span><strong>Pincode:</strong>
                                    
                                  </span>
                              </div>
                              
                          </li>
                      
                      
                      </ul>
                     
                  </div>
              </div>
                
            </div>
                </div>
        
                <div class="col-lg-6 col-md-12">
                  <div class="border p-md-4 p-3 border-radius cart-totals">
                      <div class="heading_s1 mb-3">
                          <h4> Totals</h4>
                      </div>
                      <div class="table-responsive">
                          <table class="table table-bordered">
                              <tbody>
                                  <tr>
                                      <td class="cart_total_label"> Subtotal</td>
                                      <td class="cart_total_amount"><span class="font-lg fw-900 text-brand">$price</span></td>
                                  </tr>
                                  <tr>
                                      <td class="cart_total_label">Shipping</td>
                                      <td class="cart_total_amount"><i class="ti-gift mr-2"></i> Free Shipping</td>
                                  </tr>
                                  <tr>
                                      <td class="cart_total_label">Total</td>
                                      <td class="cart_total_amount">
                                          <strong><span class="font-xl fw-900 text-brand">$price</span></strong>
                                      </td>
                                  </tr>
                              </tbody>
                          </table>
                      </div>
                  </div>
              </div>
              
              
              
        </div> -->
      </section>

    
        
     
       
        
    </main>
    <script src="/public/admin-assets/js/vendors/jquery-3.6.0.min.js"></script>
    <script src="/public/admin-assets/js/vendors/bootstrap.bundle.min.js"></script>
    <script src="/public/admin-assets/js/vendors/select2.min.js"></script>
    <script src="/public/admin-assets/js/vendors/perfect-scrollbar.js"></script>
    <script src="/public/admin-assets/js/vendors/jquery.fullscreen.min.js"></script>
    <script src="/public/admin-assets/js/vendors/chart.js"></script>
    <!-- Main Script -->
    <script src="/public/admin-assets/js/main.js" type="text/javascript"></script>
    <script src="/public/admin-assets/js/custom-chart.js" type="text/javascript"></script>

    
    <script>
        function showModal(returnReason) {
            // Assuming you have a modal with ID "reasonModal"
            console.log("Modal is being shown with reason: ", returnReason);
            var modal = document.getElementById('reasonModal');
    
            // Assuming you have a span or div inside your modal to display the reason
            var reasonElement = document.getElementById('reasonText');
            reasonElement.innerHTML = returnReason;
    
            // Show the modal
            modal.style.display = 'block';
        }
    
        function closeModal() {
            var modal = document.getElementById('reasonModal');
            modal.style.display = 'none';
        }
    </script>
        
        
        
        
        


    <script>
              
      function changeOrderStatus(orderId,productSize, prdId, newStatus,productPrice,userId,quantity) {
        const requestData = {
            orderId:orderId,
            productSize: productSize,
            productId: prdId, 
            status: newStatus,productPrice,userId,quantity
        };
        console.log(requestData)
        $.ajax({
            url: '/admin/changeOrderStatus',
            method: 'POST',
            contentType: 'application/json',
            data: JSON.stringify(requestData),
            success: function (data) {
              if(data.success){
                location.reload()
              }
                
            },
            error: function (xhr, textStatus, errorThrown) {
                
                console.error('Error:', errorThrown);
            }
        });
    }
    

    </script>
</body>


<!-- Mirrored from wp.alithemes.com/html/evara/evara-backend/index.html by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 01 Aug 2021 15:32:57 GMT -->
</html>
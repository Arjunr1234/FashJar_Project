<%- include("../partials/userHeader") %>
<style>
   .cart-container {
       margin-bottom: 20%; /* Adjust the value as needed */
   }
</style>

   <main class="main">
       <div class="page-header breadcrumb-wrap">
           <div class="container">
               <div class="breadcrumb">
                   <a href="index.html" rel="nofollow">Home</a>
                   <span></span> Shop
                   <span></span> Your Cart
               </div>
           </div>
       </div>
      
        <div class="card">
              <div class="text-center ">
                <h2 class="mt-30 ">Details</h1>
              </div>
          <div class="card-body">
            <div class="col-md-12">
               
             
      
              <div class="table-responsive">
                  <table class="table table-hover">
                      <thead>
                          <tr>
                              <th class="col-md-2 text-center" >Image</th>
                              <th class="col-md-3 text-center">Name</th>
                              <th class="col-md-1 text-center">Price</th>
                              <th class="col-md-1 text-center">Size</th>
                              <th class="col-md-1 text-center">Quantity</th>
                              <th class="col-md-2 text-center">Status</th>
                              <th class="col-md-2 text-center">Cancell/Return</th>
                              
                          </tr>
                      </thead>
                      <tbody>
                                   <% for(let i=0; i<orders.length;i++) {%>
                                    <tr>
                                      <td class="col-image col-md-2 text-center">
                                        <div class="itemside">
                                          <div class="left">
                                              <img  style="max-width:30%; height: auto;" src="/public/uploads/product-images/<%= orders[i].image[0]%>" 
                                                   class="img-sm img-thumbnail" 
                                                   alt="Item" 
                                                   width="100" 
                                                   height="100" 
                                                   
                                              >
                                          </div>
                                      </div>
                                      
                                      </td>
                                      <td class="col-name col-md-3 text-center"><%= orders[i].name %></td>
                                      <td class="col-price col-md-1 text-center">â‚¹<%= orders[i].orderDetails.productPrice %> </td>
                                      <td class="col-size col-md-1 text-center"><%= orders[i].orderDetails.size.toUpperCase() %></td>
                                      <td class="col-quantity col-md-1 text-center"><%= orders[i].orderDetails.quantity %></td>
                                      <th class="col-md-2 text-center">
                                        <% if (orders[i].orderDetails.status == 'Pending') { %>
                                          <span id="status" class="badge rounded-pill alert-warning"><%= orders[i].orderDetails.status %></span>
                                      <% } else if (orders[i].orderDetails.status == 'Processing') {%>
                                          <span id="status" class="badge rounded-pill alert-secondary"><%= orders[i].orderDetails.status %></span>
                                      <% } else if (orders[i].orderDetails.status == 'Confirmed') {%>
                                          <span id="status" class="badge rounded-pill alert-dark"><%=orders[i].orderDetails.status %></span>
                                      <% } else if (orders[i].orderDetails.status == 'Shipped') {%>
                                          <span id="status" class="badge rounded-pill alert-info"><%= orders[i].orderDetails.status %></span>
                                      <% } else if (orders[i].orderDetails.status == 'OutForDelivery') {%>
                                          <span id="status" class="badge rounded-pill alert-warning"><%= orders[i].orderDetails.status %></span>
                                      <% } else if (orders[i].orderDetails.status == 'Delivered') {%>
                                          <span id="status" class="badge rounded-pill alert-success"><%= orders[i].orderDetails.status %></span>
                                      <% } else if (orders[i].orderDetails.status == 'cancelPending') {%>
                                          <span id="status" class="badge rounded-pill alert-warning"><%= orders[i].orderDetails.status %></span>
                                      <% } else {%>
                                          <span id="status" class="badge rounded-pill alert-danger"><%= orders[i].orderDetails.status %></span>
                                      <% } %>
                                      </th>
                                      </td>
                                      <td class="col-cancell col-md-2 text-center">
                                        <% if(orders[i].orderDetails.status === 'Delivered') {%>
                                          <a  class="btn btn-sm font-sm btn-action btn-warning" style="width: 50%; padding: 5px; font-size: 12px; background:rgb(255, 200, 0)" onclick="returnProduct('<%= orders[i].orderId %>','<%= orders[i].orderDetails.product %>','<%= orders[i].orderDetails.size %>','<%= orders[i].orderDetails.quantity %>')">Return</a>

                                          <%} else if( orders[i].orderDetails.status ===  "Cancelled"){%>

                                            <%} else if( orders[i].orderDetails.status ===  "Return pending"){%>
  
                                              <%}else if( orders[i].orderDetails.status ===  "Returned"){%>
  
                                                <%}

                                            else {%>
                                              <a class="btn btn-sm font-sm btn-action btn-warning" style="width: 50%; padding: 5px; font-size: 12px; background:red" onclick="cancelProduct('<%= orders[i].orderId %>','<%= orders[i].orderDetails.product %>','<%= orders[i].orderDetails.size %>','<%= orders[i].orderDetails.quantity %>')">Cancel</a>
  
                                              <%}
                                             %>
                                    </td>
                                    
                                     
                                  </tr>
                                    
                                    <%} %>
      
                             
                                     
                                      
                                          
                      </tbody>
                    </table>
                </div>
              </div>      
           <!-- .row // -->
          </div> 
      </div> <!-- card .// -->
      
      
       
       
       
   </main>
   
   <!-- Preloader Start -->
   
   <!-- Vendor JS-->
   <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
   <script src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
   <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
   <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
   <script src="/public/assets/js/vendor/modernizr-3.6.0.min.js"></script>
   <script src="/public/assets/js/vendor/jquery-3.6.0.min.js"></script>
   <script src="/public/assets/js/vendor/jquery-migrate-3.3.0.min.js"></script>
   <script src="/public/assets/js/vendor/bootstrap.bundle.min.js"></script>
   <script src="/public/assets/js/plugins/slick.js"></script>
   <script src="/public/assets/js/plugins/jquery.syotimer.min.js"></script>
   <script src="/public/assets/js/plugins/wow.js"></script>
   <script src="/public/assets/js/plugins/jquery-ui.js"></script>
   <script src="/public/assets/js/plugins/perfect-scrollbar.js"></script>
   <script src="/public/assets/js/plugins/magnific-popup.js"></script>
   <script src="/public/assets/js/plugins/select2.min.js"></script>
   <script src="/public/assets/js/plugins/waypoints.js"></script>
   <script src="/public/assets/js/plugins/counterup.js"></script>
   <script src="/public/assets/js/plugins/jquery.countdown.min.js"></script>
   <script src="/public/assets/js/plugins/images-loaded.js"></script>
   <script src="/public/assets/js/plugins/isotope.js"></script>
   <script src="/public/assets/js/plugins/scrollup.js"></script>
   <script src="/public/assets/js/plugins/jquery.vticker-min.js"></script>
   <!-- Template  JS -->
   <script src="/public/assets/js/maind134.js?v=3.4"></script>
   <script src="/public/assets/js/shopd134.js?v=3.4"></script>
</body>
<script>
   
  function cancelProduct(orderId, productId, size,quantity) {
    const requestedData = {
      orderId: orderId,
      productId: productId,
      size: size,quantity
    };
   // const cancelledButton = document.getElementById("buttonCancelled")
  
    Swal.fire({
      text: "Do you want to Cancell your Order?",
      buttons: ["cancel", true],
  }).then((result) => {
    if(result.isConfirmed){

      $.ajax({
        url: '/deleteOrder',
        method: 'POST',
        contentType: 'application/json',
        data: JSON.stringify(requestedData),
        success: function (data) {
          if(data.success){
           
           swal("Order is Cancelled", {
            icon: "success",
        }).then(() => {
            location.reload();
            document.getElementById("buttonCancelled").disable = true
          })
          }else{
            console.log("delete order is failed")
            
          }
  
        },
        error: function (xhr, textStatus, errorThrown) {
          console.error("Error: ", errorThrown);
        }
      });

    }
  }) 

    
  }
  

 function returnProduct(orderId, productId, size,quantity){

        const requestedData = {
          orderId : orderId,
          productId: productId,
          size, quantity
        }

        Swal.fire({
          text: "Do you want to Return your Product?",
          buttons: ["cancel", true],
      }).then((result)=>{
         if(result.isConfirmed){
          $.ajax({
            url:"/retrunProduct",
            method:"POST",
            contentType:'application/json',
            data:JSON.stringify(requestedData),
            success:function(data){
                 if(data.success){
                 console.log("Entered in to success is true")
                  swal("Return request is Accepted", {
                   icon: "success",
               }).then(() => {
                   location.reload();
                   
                 })
                 }
 
            }
         })

         }
      })

       

 }
   

</script>

<!-- Mirrored from wp.alithemes.com/html/evara/evara-frontend/shop-cart.html by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 15 Jul 2023 10:10:07 GMT -->
</html>